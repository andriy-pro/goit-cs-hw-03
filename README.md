# goit-cs-hw-03

Repository for the homework solution from the GoIT course "Computer Systems and Their Fundamentals", HW-3.

## Опис рішення завдання 1 

> **Примітка:** назва бази даних, що використовується в цьому проєкті, – `task_management` !  
> Налаштування для підключення до бази даних PostgreSQL вказані у файлі [`config.py`](src/task_1/config.py).

Цей проєкт демонструє повний цикл роботи з базою даних PostgreSQL у Docker-контейнері:  
- Створення й ініціалізація бази даних (створення необхідних таблиць та їх структури).
- Заповнення бази даними скриптом `seed.py`, який використовує бібліотеку Faker для генерування випадкових даних.
- Виконання різноманітних запитів до бази даних (`SELECT`, `INSERT`, `UPDATE`, `DELETE`), а також більш складних запитів з підзапитами та `JOIN`.

## Скрипт `process_requests.py`

Файл `process_requests.py` дозволяє автоматизувати виконання SQL-запитів з файлу `requests.sql`. Він:  
1. **Зчитує запити з файлу `requests.sql`**. Кожен запит має бути попередньо задокументований коментарем, що описує, яку операцію виконує запит.  
2. **Валідує синтаксис SQL-запитів** перед виконанням.  
3. **Виконує запити по черзі** й питає у користувача підтвердження перед кожним запитом.  
4. **Виводить результати запитів у зрозумілому форматі**, а також логує успішні та помилкові виконання у JSON-лог (`db_log.json` або інший вказаний файл).  
5. **При SELECT-запитах відображає всі отримані рядки**, а при операціях вставки, оновлення чи видалення – інформує про кількість змінених рядків або повідомляє про успішне виконання.  
6. **Може зберігати успішні та помилкові результати виконання у різні файли**, що робить налагодження та аналіз роботи більш зручними.

### Вимоги до вхідного файлу `requests.sql`

Файл `requests.sql` має особливий формат:  
- Перед кожним запитом рекомендовано вказувати коментар-опис, наприклад:  
  ```sql
  -- (1) Отримати всі завдання певного користувача (наприклад user_id = 1)
  SELECT * FROM tasks WHERE user_id = 1;
  ```
- Коментарі `-- (N) Опис` допомагають ідентифікувати призначення кожного запиту.  
- Кожен запит повинен бути відділений порожнім рядком або коментарем, а також правильно завершуватися крапкою з комою `;`.  
- Запити не повинні бути порожніми та повинні бути коректними з точки зору SQL-синтаксису.

Таким чином `process_requests.py` може "парсити" файл `requests.sql`, відображати кожен запит разом із описом, запитувати у користувача підтвердження та виконувати запит у базі даних.

## Додаткова інформація

- `seed.py` – скрипт заповнює таблиці випадковими даними (користувачі, статуси завдань, завдання), використовуючи Faker. Це дозволяє швидко підготувати тестове середовище для перевірки запитів.
- `schema.sql` – містить інструкції зі створення таблиць `users`, `status`, `tasks` із необхідними ключами, зв’язками, унікальними полями та каскадним видаленням.

## Команди Docker та PostgreSQL

Нижче наведено корисні команди, використані в проєкті, для керування базою даних та контейнером:

**Створення контейнера:**
```bash
docker run --name postgress-cs-hw-03 -p 5432:5432 -e POSTGRES_PASSWORD=goit -d postgres
```

**Запуск контейнера, якщо він був створений раніше, але зараз зупинений:**
```bash
docker start postgress-cs-hw-03
```

**Встановлення PostgreSQL Client (Ubuntu):**
```bash
sudo apt update
sudo apt install postgresql-client-common postgresql-client
psql --version
```

**Підключення до сервера PostgreSQL для перевірки:**
```bash
psql -h localhost -p 5432 -U postgres
```

**Список доступних баз даних (у консолі PostgreSQL):**
```sql
\l
```

**Створення бази даних:**
```sql
CREATE DATABASE task_management;
```

**Виконання скрипту `schema.sql`:**
```bash
psql -h localhost -p 5432 -U postgres -d task_management -f schema.sql
```

**Підключення до бази даних `task_management` для перевірки структури:**
```bash
psql -h localhost -p 5432 -U postgres -d task_management
```

**Список створених таблиць:**
```sql
\dt
```

**Видалення даних з таблиць (із урахуванням залежностей):**
```sql
TRUNCATE TABLE tasks, users, status RESTART IDENTITY CASCADE;
```

**Перевірка кількості записів у таблицях:**
```sql
SELECT COUNT(*) FROM tasks;
SELECT COUNT(*) FROM users;
SELECT COUNT(*) FROM status;
```
